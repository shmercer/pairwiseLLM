<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Create a Gemini Batch job from request objects — gemini_create_batch • pairwiseLLM</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Inter-0.4.10/font.css" rel="stylesheet"><link href="../deps/JetBrains_Mono-0.4.10/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Create a Gemini Batch job from request objects — gemini_create_batch"><meta name="description" content="This is a thin wrapper around the REST endpoint
/v1beta/models/&amp;lt;MODEL&amp;gt;:batchGenerateContent. It accepts a list of
GenerateContent request objects and returns the created Batch job."><meta property="og:description" content="This is a thin wrapper around the REST endpoint
/v1beta/models/&amp;lt;MODEL&amp;gt;:batchGenerateContent. It accepts a list of
GenerateContent request objects and returns the created Batch job."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">pairwiseLLM</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.3.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home"></span> Home</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-usage-guides" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Usage Guides</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-usage-guides"><li><a class="dropdown-item" href="../articles/getting-started.html">Getting Started with pairwiseLLM</a></li>
    <li><a class="dropdown-item" href="../articles/advanced-batch-workflows.html">Advanced: Submitting and Polling Multiple Batches</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-adaptive-pairing" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Adaptive Pairing</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-adaptive-pairing"><li><a class="dropdown-item" href="../articles/adaptive-pairing.html">Adaptive Pairing &amp; Ranking</a></li>
    <li><a class="dropdown-item" href="../articles/bayesian-btl-adaptive-pairing-design.html">Design: Bayesian BTL Adaptive Pairing</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../articles/prompt-template-bias.html">Template Positional Bias</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/shmercer/pairwiseLLM" aria-label="GitHub"><span class="fa fa-github"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Create a Gemini Batch job from request objects</h1>
      <small class="dont-index">Source: <a href="https://github.com/shmercer/pairwiseLLM/blob/master/R/gemini_batch_api.R" class="external-link"><code>R/gemini_batch_api.R</code></a></small>
      <div class="d-none name"><code>gemini_create_batch.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This is a thin wrapper around the REST endpoint
<code>/v1beta/models/&lt;MODEL&gt;:batchGenerateContent</code>. It accepts a list of
GenerateContent request objects and returns the created Batch job.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">gemini_create_batch</span><span class="op">(</span></span>
<span>  <span class="va">requests</span>,</span>
<span>  <span class="va">model</span>,</span>
<span>  api_key <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"GEMINI_API_KEY"</span><span class="op">)</span>,</span>
<span>  api_version <span class="op">=</span> <span class="st">"v1beta"</span>,</span>
<span>  display_name <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-requests">requests<a class="anchor" aria-label="anchor" href="#arg-requests"></a></dt>
<dd><p>List of GenerateContent request objects, each of the form
<code>list(contents = ..., generationConfig = ...)</code>. You can obtain this
list from the output of <code><a href="build_gemini_batch_requests.html">build_gemini_batch_requests</a></code> via
<code>batch$request</code>.</p></dd>


<dt id="arg-model">model<a class="anchor" aria-label="anchor" href="#arg-model"></a></dt>
<dd><p>Gemini model name, for example <code>"gemini-3-pro-preview"</code>.</p></dd>


<dt id="arg-api-key">api_key<a class="anchor" aria-label="anchor" href="#arg-api-key"></a></dt>
<dd><p>Optional Gemini API key. Defaults to
<code>Sys.getenv("GEMINI_API_KEY")</code>.</p></dd>


<dt id="arg-api-version">api_version<a class="anchor" aria-label="anchor" href="#arg-api-version"></a></dt>
<dd><p>API version string for the path; defaults to
<code>"v1beta"</code>.</p></dd>


<dt id="arg-display-name">display_name<a class="anchor" aria-label="anchor" href="#arg-display-name"></a></dt>
<dd><p>Optional display name for the batch.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list representing the Batch job object returned by Gemini.
Important fields include <code>name</code>, <code>metadata$state</code>,
and (after completion) <code>response$inlinedResponses</code> or
<code>response$responsesFile</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Typically you will not call this directly; instead, use
<code><a href="run_gemini_batch_pipeline.html">run_gemini_batch_pipeline</a></code> which builds requests from a tibble
of pairs, creates the batch, polls for completion, and parses the results.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># --- Offline preparation: build GenerateContent requests ---</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"example_writing_samples"</span>, package <span class="op">=</span> <span class="st">"pairwiseLLM"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">pairs</span> <span class="op">&lt;-</span> <span class="va">example_writing_samples</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="make_pairs.html">make_pairs</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="sample_pairs.html">sample_pairs</a></span><span class="op">(</span>n_pairs <span class="op">=</span> <span class="fl">2</span>, seed <span class="op">=</span> <span class="fl">123</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">td</span> <span class="op">&lt;-</span> <span class="fu"><a href="trait_description.html">trait_description</a></span><span class="op">(</span><span class="st">"overall_quality"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tmpl</span> <span class="op">&lt;-</span> <span class="fu"><a href="set_prompt_template.html">set_prompt_template</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">batch_tbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="build_gemini_batch_requests.html">build_gemini_batch_requests</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  pairs             <span class="op">=</span> <span class="va">pairs</span>,</span></span>
<span class="r-in"><span>  model             <span class="op">=</span> <span class="st">"gemini-3-pro-preview"</span>,</span></span>
<span class="r-in"><span>  trait_name        <span class="op">=</span> <span class="va">td</span><span class="op">$</span><span class="va">name</span>,</span></span>
<span class="r-in"><span>  trait_description <span class="op">=</span> <span class="va">td</span><span class="op">$</span><span class="va">description</span>,</span></span>
<span class="r-in"><span>  prompt_template   <span class="op">=</span> <span class="va">tmpl</span>,</span></span>
<span class="r-in"><span>  thinking_level    <span class="op">=</span> <span class="st">"low"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Extract the list of request objects</span></span></span>
<span class="r-in"><span><span class="va">requests</span> <span class="op">&lt;-</span> <span class="va">batch_tbl</span><span class="op">$</span><span class="va">request</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Inspect a single GenerateContent request (purely local)</span></span></span>
<span class="r-in"><span><span class="va">requests</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $contents</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $contents[[1]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $contents[[1]]$role</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "user"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $contents[[1]]$parts</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $contents[[1]]$parts[[1]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $contents[[1]]$parts[[1]]$text</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "You are a debate adjudicator. Your task is to weigh the comparative strengths of two writing samples regarding a specific trait.\n\nTRAIT: Overall Quality\nDEFINITION: Overall quality of the writing, considering how well ideas are expressed,\n      how clearly the writing is organized, and how effective the language and\n      conventions are.\n\nSAMPLES:\n\n=== SAMPLE_1 ===\nEvaluating writing is challenging because no rubric can fully capture what\n    makes a text effective for a particular audience. Two essays might receive\n    the same score for completely different reasons, obscuring the feedback\n    loop.\n\n=== SAMPLE_2 ===\nWriting assessment is challenging because of the trade-off between\n    validity and reliability. Highly standardized scoring protocols often strip\n    away the subjective appreciation of voice and creativity, while holistic\n    scoring captures the 'whole' but risks being unreliable.\n\nEVALUATION PROCESS (Mental Simulation):\n\n1.  **Advocate for SAMPLE_1**: Mentally list the single strongest point of evidence that makes SAMPLE_1 the winner.\n2.  **Advocate for SAMPLE_2**: Mentally list the single strongest point of evidence that makes SAMPLE_2 the winner.\n3.  **Adjudicate**: Compare the *strength of the evidence* identified in steps 1 and 2. Which sample provided the more compelling demonstration of the definition above?\n\nCRITICAL:\n- You must construct a mental argument for BOTH samples before deciding.\n- Do not default to the first sample read.\n- If the samples are close, strictly follow the trait definition to break the tie.\n\nFINAL DECISION:\nOutput your decision based on the stronger evidence.\n\n&lt;BETTER_SAMPLE&gt;SAMPLE_1&lt;/BETTER_SAMPLE&gt;\nOR\n&lt;BETTER_SAMPLE&gt;SAMPLE_2&lt;/BETTER_SAMPLE&gt;\n\n(Provide only the XML tag)."</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $generationConfig</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $generationConfig$thinkingConfig</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $generationConfig$thinkingConfig$includeThoughts</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $generationConfig$thinkingConfig$thinkingLevel</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Low"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># --- Online step: create the Gemini Batch job ---</span></span></span>
<span class="r-in"><span><span class="co"># Requires network access and a valid Gemini API key.</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="va">batch</span> <span class="op">&lt;-</span> <span class="fu">gemini_create_batch</span><span class="op">(</span></span></span>
<span class="r-in"><span>  requests <span class="op">=</span> <span class="va">requests</span>,</span></span>
<span class="r-in"><span>  model    <span class="op">=</span> <span class="st">"gemini-3-pro-preview"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">batch</span><span class="op">$</span><span class="va">name</span></span></span>
<span class="r-in"><span><span class="va">batch</span><span class="op">$</span><span class="va">metadata</span><span class="op">$</span><span class="va">state</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Sterett H. Mercer.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

