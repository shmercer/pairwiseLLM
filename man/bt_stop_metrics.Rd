% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/bt_stopping.R
\name{bt_stop_metrics}
\alias{bt_stop_metrics}
\title{Compute stopping metrics from a Bradleyâ€“Terry model fit}
\usage{
bt_stop_metrics(fit, se_probs = c(0.5, 0.9, 0.95), fit_bounds = c(0.7, 1.3))
}
\arguments{
\item{fit}{A list returned by \code{\link{fit_bt_model}}.}

\item{se_probs}{Numeric vector of probabilities for SE quantiles. Default:
\code{c(0.5, 0.9, 0.95)}.}

\item{fit_bounds}{Numeric length-2 vector giving lower/upper bounds for
acceptable infit/outfit. Default: \code{c(0.7, 1.3)}.}
}
\value{
A one-row tibble with summary metrics. Key columns include:
\describe{
\item{engine}{Modeling engine used ("sirt", "BradleyTerry2", or \code{NA}).}
\item{n_items}{Number of objects in \code{fit$theta}.}
\item{theta_sd}{SD of \code{theta}.}
\item{se_mean}{Mean SE.}
\item{se_p90}{90th percentile SE (if requested in \code{se_probs}).}
\item{se_p95}{95th percentile SE (if requested in \code{se_probs}).}
\item{se_max}{Maximum SE.}
\item{rel_se_mean}{\code{se_mean / theta_sd} (scale-free; \code{NA} if \code{theta_sd <= 0}).}
\item{rel_se_p90}{\code{se_p90 / theta_sd} (scale-free; \code{NA} if \code{theta_sd <= 0}).}
\item{reliability}{MLE reliability (typically for \pkg{sirt}) or \code{NA}.}
\item{sepG}{Separation index if available, otherwise \code{NA}.}
\item{item_misfit_prop}{Proportion of items with infit/outfit outside \code{fit_bounds}.}
\item{judge_misfit_prop}{Proportion of judges with infit/outfit outside \code{fit_bounds}.}
}
}
\description{
This helper computes round-level summary metrics that are useful for adaptive
sampling and stopping decisions. It is designed to work with the object returned
by \code{\link{fit_bt_model}}.
}
\details{
The output includes precision summaries (SE distribution), scale summaries
(SD of \code{theta}), and scale-free precision metrics (SE / SD(theta)).
If diagnostic outputs are available (from \code{fit_bt_model(..., return_diagnostics = TRUE)}
using the \pkg{sirt} engine), the output also includes separation index (\code{sepG})
and item/judge misfit proportions based on infit/outfit bounds.
}
\examples{
# Minimal example using a mock fit object (runs without sirt installed)
fit_mock <- list(
  engine = "mock",
  reliability = 0.90,
  theta = tibble::tibble(
    ID = c("A", "B", "C"),
    theta = c(0.0, 1.0, -1.0),
    se = c(0.3, 0.2, 0.4)
  )
)
bt_stop_metrics(fit_mock)

# Real example (only runs if sirt is installed)
if (requireNamespace("sirt", quietly = TRUE)) {
  data("example_writing_pairs", package = "pairwiseLLM")
  bt <- build_bt_data(example_writing_pairs)
  fit <- fit_bt_model(bt, engine = "sirt", verbose = FALSE, return_diagnostics = TRUE)
  bt_stop_metrics(fit)
}

}
