% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/openai_batch_api.R
\name{openai_download_batch_output}
\alias{openai_download_batch_output}
\title{Download the output file for a completed batch}
\usage{
openai_download_batch_output(
  batch_id,
  path,
  api_key = Sys.getenv("OPENAI_API_KEY")
)
}
\arguments{
\item{batch_id}{The batch ID (e.g. \code{"batch_abc123"}).}

\item{path}{Local file path to write the downloaded \code{.jsonl} output.}

\item{api_key}{Optional OpenAI API key.}
}
\value{
Invisibly, the path to the downloaded file.
}
\description{
Given a batch ID, retrieves the batch metadata, extracts the \code{output_file_id},
and downloads the corresponding file content to \code{path}.
}
\examples{
# Mocked example:
if (requireNamespace("testthat", quietly = TRUE)) {
  fake_batch <- list(
    id             = "batch_123",
    status         = "completed",
    output_file_id = "file_out_123"
  )

  testthat::with_mocked_bindings(
    openai_get_batch  = function(batch_id, api_key) fake_batch,
    .openai_request   = function(path, api_key) structure(list(), class = "fake_req"),
    httr2::req_perform = function(req) list(),
    httr2::resp_body_raw = function(resp) charToRaw('{"dummy": true}\n'),
    {
      tf <- tempfile(fileext = ".jsonl")
      openai_download_batch_output("batch_123", tf)
      readLines(tf)
    }
  )
}

\dontrun{
openai_download_batch_output("batch_abc123", "batch_output.jsonl")
res <- parse_openai_batch_output("batch_output.jsonl")
}

}
