% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/anthropic_live.R
\name{anthropic_compare_pair_live}
\alias{anthropic_compare_pair_live}
\title{Live Anthropic (Claude) comparison for a single pair of samples}
\usage{
anthropic_compare_pair_live(
  ID1,
  text1,
  ID2,
  text2,
  model,
  trait_name,
  trait_description,
  prompt_template = set_prompt_template(),
  tag_prefix = "<BETTER_SAMPLE>",
  tag_suffix = "</BETTER_SAMPLE>",
  api_key = Sys.getenv("ANTHROPIC_API_KEY"),
  anthropic_version = "2023-06-01",
  reasoning = c("none", "enabled"),
  include_raw = FALSE,
  ...
)
}
\arguments{
\item{ID1}{Character ID for the first sample.}

\item{text1}{Character string containing the first sample's text.}

\item{ID2}{Character ID for the second sample.}

\item{text2}{Character string containing the second sample's text.}

\item{model}{Anthropic Claude model name (for example
\code{"claude-sonnet-4-5"}, \code{"claude-haiku-4-5"},
or \code{"claude-opus-4-5"}).}

\item{trait_name}{Short label for the trait (for example "Overall Quality").}

\item{trait_description}{Full-text definition of the trait.}

\item{prompt_template}{Prompt template string, typically from
\code{\link{set_prompt_template}}. The template should embed the full
instructions, rubric text, and \verb{<BETTER_SAMPLE>} tagging convention.}

\item{tag_prefix}{Prefix for the better-sample tag. Defaults to
\code{"<BETTER_SAMPLE>"}.}

\item{tag_suffix}{Suffix for the better-sample tag. Defaults to
\code{"</BETTER_SAMPLE>"}.}

\item{api_key}{Optional Anthropic API key. Defaults to
\code{Sys.getenv("ANTHROPIC_API_KEY")}.}

\item{anthropic_version}{Anthropic API version string passed as the
\code{anthropic-version} HTTP header. Defaults to \code{"2023-06-01"}.}

\item{reasoning}{Character scalar indicating whether to use additional
"reasoning-style" chain-of-thought in the model prompt. Currently two
values are recognised:
\itemize{
\item \code{"none"} – standard prompting (recommended default).
\item \code{"enabled"} – reserved for future use; you can use this to
drive different temperature / max token settings or prompt templates
when experimenting with longer reasoning traces.
}
This argument is provided to mirror OpenAI's \code{reasoning} concept but
is not directly sent as a separate parameter to the Anthropic API.}

\item{include_raw}{Logical; if \code{TRUE}, adds a list-column
\code{raw_response} containing the parsed JSON body returned by Anthropic
(or \code{NULL} on parse failure). This is useful for debugging parsing
problems.}

\item{...}{Additional Anthropic parameters such as \code{max_tokens},
\code{temperature}, or \code{top_p}, which will be passed through to the
Messages API.}
}
\value{
A tibble with one row and columns:
\describe{
\item{custom_id}{ID string of the form \code{"LIVE_<ID1>_vs_<ID2>"}.}
\item{ID1, ID2}{The sample IDs you supplied.}
\item{model}{Model name reported by the API.}
\item{object_type}{Anthropic object type (for example \code{"message"}).}
\item{status_code}{HTTP-style status code (200 if successful).}
\item{error_message}{Error message if something goes wrong; otherwise NA.}
\item{content}{Concatenated text from the assistant output.}
\item{better_sample}{"SAMPLE_1", "SAMPLE_2", or NA.}
\item{better_id}{ID1 if SAMPLE_1 is chosen, ID2 if SAMPLE_2 is chosen,
otherwise NA.}
\item{prompt_tokens}{Prompt / input token count (if reported).}
\item{completion_tokens}{Completion / output token count (if reported).}
\item{total_tokens}{Total token count (if reported).}
\item{raw_response}{(Optional) list-column containing the parsed JSON body.}
}
}
\description{
This function sends a single pairwise comparison prompt to the Anthropic
Messages API (Claude models) and parses the result into a small tibble.
}
\details{
It mirrors the behaviour and output schema of
\code{\link{openai_compare_pair_live}}, but targets Anthropic's
\code{/v1/messages} endpoint. The prompt template, \verb{<BETTER_SAMPLE>} tag
convention, and downstream parsing / BT modelling can remain unchanged.

The function is designed to work with Claude models such as Sonnet, Haiku,
and Opus in the "4.5" family. You can pass any valid Anthropic model string,
for example:
\itemize{
\item \code{"claude-sonnet-4-5"}
\item \code{"claude-haiku-4-5"}
\item \code{"claude-opus-4-5"}
}
The API typically responds with a dated model string such as
\code{"claude-sonnet-4-5-20250929"} in the \code{model} field.

\strong{Recommended defaults for pairwise writing comparisons}

For stable, reproducible comparisons we recommend:
\itemize{
\item \code{temperature = 0} (deterministic comparisons).
\item \code{max_tokens = 768} (enough room for explanation and the
\verb{<BETTER_SAMPLE>} tag).
}

If you do not supply \code{temperature} or \code{max_tokens} explicitly,
this function will use these values by default for pairwise tasks.
}
\examples{
\dontrun{
# Requires ANTHROPIC_API_KEY and network access.
library(pairwiseLLM)

data("example_writing_samples", package = "pairwiseLLM")
samples <- example_writing_samples[1:2, ]

td   <- trait_description("overall_quality")
tmpl <- set_prompt_template()

res_claude <- anthropic_compare_pair_live(
  ID1               = samples$ID[1],
  text1             = samples$text[1],
  ID2               = samples$ID[2],
  text2             = samples$text[2],
  model             = "claude-sonnet-4-5",
  trait_name        = td$name,
  trait_description = td$description,
  prompt_template   = tmpl,
  temperature       = 0,
  max_tokens        = 768,
  reasoning         = "none",
  include_raw       = FALSE
)

res_claude$better_id
}

}
